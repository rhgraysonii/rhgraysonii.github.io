<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Ruby Tutorial &#8211; Site Title</title>

<meta name="keywords" content="">



<!-- Twitter Cards -->
<meta name="twitter:title" content="Ruby Tutorial">




<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://localhost:4000/images/site-logo.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Ruby Tutorial">

<meta property="og:url" content="http://localhost:4000/ruby-tutorial/">
<meta property="og:site_name" content="Site Title">





<link rel="canonical" href="http://localhost:4000/ruby-tutorial/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Site Title Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
<!-- Webfonts -->
<script src="//use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="http://localhost:4000/assets/js/vendor/html5shiv.min.js"></script>
  <script src="http://localhost:4000/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		        
		    
		    <li><a href="http://localhost:4000/about/" >About</a></li>
		  
		    
		        
		    
		    <li><a href="http://localhost:4000/articles/" >Articles</a></li>
		  
		    
		        
		    
		    <li><a href="http://localhost:4000/blog/" >Blog</a></li>
		  
		    
		        
		    
		    <li><a href="http://localhost:4000/theme-setup/" >Theme Setup</a></li>
		  
		    
		        
		        
		    <li><a href="http://mademistakes.com" target="_blank">Made Mistakes</a></li>
		  
		    
		        
		    
		    <li><a href="http://localhost:4000/search/" >Search</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
  		<a href="http://localhost:4000/" class="site-logo" rel="home" title="Site Title"><img src="http://localhost:4000/images/site-logo.png" width="200" height="200" alt="Site Title logo" class="animated fadeInDown"></a>
      
      <h1 class="site-title animated fadeIn"><a href="http://localhost:4000/">Site Title</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">Describe your website here.</h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"></span>
        
          <h1 class="entry-title">Ruby Tutorial</h1>
        
      </header>
      <footer class="entry-meta">
        
        
        
          <img src="http://localhost:4000/images/bio-photo.jpg" class="bio-photo" alt="Your Name bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Your Name</span></span>
        <span class="entry-date date published"><time datetime="2015-03-18T21:18:07-04:00"><i class="fa fa-calendar-o"></i> March 18, 2015</time></span>
        
        
        
        
      </footer>
      <div class="entry-content">
        <h1 id="building-something-more-complex">Building Something More Complex</h1>

<p>Now, this <code>Bob</code> class and any test we have written, let us be honest with ourselves, they are the
very definition of trivial. However, we now have a scaffold that will let us build a more complex
application. In order to do this were going to do a few things. First, we should start utilizing
<code>git</code>. </p>

<pre><code class="language-BASH">git init
git add .
git commit -m 'initial commit'
</code></pre>

<p>Now, in order to read about git, I heavily recommend <a href="http://www.gitbook.com">The Git Book</a> if you want an in
depth primer. However, if you want the basic idea of git, here is what it allows us to do:
we have a very simple way of tracking line by line changes in a document, that are stored on a
tree. We can branch from this, diff work, and combine work. It is a wonderful tool and considered
a standard part of the arsenal for any Rubyist. Now, how about we make this class something
that actually seems to have a goal. Why not make a Ruby interface that will allow us to search
Amazon. This could be fun!</p>

<pre><code class="language-BASH">git mv lib/bob.rb lib/scraper.rb
git mv spec/my_first_spec.rb spec/scraper_spec.rb
editor lib/scraper_spec.rb
</code></pre>

<pre><code class="language-RUBY">require './lib/scraper'

describe Scraper do
  let(:browser) { Scraper::Browser.new }
  it "is in fact a Browser" do
    expect(browser.class).to eq Mechanize
  end
end
</code></pre>

<p>With these changes, we should get a new failure when we run all of these.</p>

<p><code>rspec spec/scraper_spec.rb</code></p>

<pre><code>bobby@devbox:~/ruby_tutorial-ocr/some_dir$ rspec spec/scraper_spec.rb 
/home/bobby/ruby_tutorial-ocr/some_dir/spec/scraper_spec.rb:3:in 
&lt;top (required)&gt;: uninitialized constant Scraper::Brwoser (NameError)

</code></pre>

<p>A new failure. So now we can modify the old class to make it passing!</p>

<p><code>editor lib/scraper.rb</code></p>

<pre><code class="language-RUBY">require 'mechanize'

module Scraper 
  class Browser 
    def initialize
      @browser = Mechanize.new { |x| x.user_agent_alias = "Mac Safari" }
    end

    def browser
      @browser
    end
  end
end

</code></pre>
<p>There is quite a bit of change here so we will break it down piece by piece.</p>

<p>First of all, we have created a module to wrap everything in. This provides
us not only an easy way to package whatever we make with other Ruby code,
but also provides us a way to start thinking about bigger architecture.
Inside the module Scraper, we make a class <code>Browser</code>. This class, when instantiated will spawn
a Mechanize instance that is using the Mac Safari user agent alias. Now that we have this, we
will be able to go out and scrape some data to get things from amazing.com via our Ruby wrapper.</p>

<p>Time for another test:</p>

<pre><code class="language-RUBY">...
    it "can get amazon's main page" do
      expect(browser.amazon.uri.to_s).to eq 'http://www.amazon.com/'
    end
...
</code></pre>

<p>Now, we know this will fail, but we pop into our module:</p>

<p><code>editor lib/scraper.rb</code></p>

<pre><code class="language-RUBY">require 'mechanize'

$AMAZON_URL = 'http://www.amazon.com/'

module Scraper 
  class Browser 
    def initialize
      @browser = Mechanize.new { |x| x.user_agent_alias = "Mac Safari" }
    end

    def browser
      @browser
    end

    def amazon
      @browser.get($AMAZON_URL)
    end
  end
end

</code></pre>

<p>By defining the constant <code>AMAZON_URL</code> and also getting the page, we now have successfully reached
Amazon. Time to find the search form.</p>

<h2 id="automating-testing">Automating Testing</h2>
<p><code>Guard</code> is a systems tool and Gem that will allow us to trivially run our specs whenever they change. In order to use guard,
we first make some gemfile changes:</p>

<pre><code class="language-RUBY">source "https://rubygems.org"

gem "mechanize"
# gem "tesseract-ocr" for later ;)

group :test, :development do
  gem "rspec"
  gem "guard"
  gem "guard-rspec"
  gem "guard-bundler"
end

</code></pre>

<p>This sets us up with guard, and the related plugins that will allow us to run it easily. Now that we are getting robust with
our testing, we are going to make what is commonly known as a <code>spec_helper</code> as well.</p>

<p><code>editor spec/spec_helper.rb</code></p>

<pre><code class="language-RUBY">$LOAD_PATH.unshift(File.dirname(__FILE__))
$LOAD_PATH.unshift(File.join(File.dirname(__FILE__), '..', 'lib'))
require 'scraper'
</code></pre>
<p>Now, we will be loading by default all our modules in here so our specs can just <code>'require spec_helper'</code> and we will be good
to go. So letâ€™s make that change at the top</p>

<p><code>editor spec/scraper_spec.rb</code></p>

<pre><code>require 'spec_helper'
...
</code></pre>

<p>and now we can run</p>

<p><code>bundle exec guard init</code></p>

<p>And any time we change one of our tests, it will automatically run. Try it out!
#### <a href="/introduction/bot_two.md">Interacting With the Web Using Our Bot</a></p>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="http://localhost:4000/blog/hello-world/" class="btn" title="Hello World">Previous</a>
      
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>&copy; 2015 Your Name. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/so-simple/" rel="nofollow">So Simple Theme</a>.</span>
<div class="social-icons">
	
	
	
	
	
	
	
	
	
	
  <a href="http://localhost:4000/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->
  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = 'http://localhost:4000';
</script>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>




</body>
</html>
